<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Holiday Hub</title>
    <link rel="stylesheet" href="styles/theme.css" />
  </head>
  <body>
    <a class="skip-link" href="#greetings">Skip to content</a>
    <header class="hero">
      <div class="parallax-scene" aria-hidden="true">
        <div class="sky layer" data-depth="0.1"></div>
        <div class="stars layer" data-depth="0.12"></div>
        <div class="hills layer" data-depth="0.2"></div>
        <div class="ribbon layer" data-depth="0.35"></div>
        <div class="foreground layer" data-depth="0.5"></div>
        <canvas id="snow-canvas" class="snow layer" data-depth="0.1"></canvas>
        <div class="snow-fallback" hidden>
          <div class="flake"></div>
          <div class="flake"></div>
          <div class="flake"></div>
          <div class="flake"></div>
          <div class="flake"></div>
        </div>
        <div class="bottle-3d" role="presentation" aria-hidden="true">
          <div class="bottle-body">
            <div class="bottle-label">Coca-Cola</div>
            <div class="bottle-cap"></div>
          </div>
        </div>
      </div>

      <div class="container content">
        <p class="badge">Holiday lounge</p>
        <h1>Season's greetings</h1>
        <p>
          Gather around the digital fireplace for heartfelt cards, cozy
          mini-games, and a cheerful guestbook to share the joy.
        </p>
        <div class="actions">
          <a class="btn glow-accent" href="#games">Play mini-games</a>
          <a class="btn secondary" href="#guestbook">Sign the guestbook</a>
        </div>
      </div>
    </header>

    <main>
      <section class="section" id="greetings">
        <div class="container">
          <h2 class="section-title">Festive greetings</h2>
          <p class="section-subtitle">
            Swipe through cards and warm wishes from friends everywhere.
          </p>
          <div class="carousel" aria-label="Holiday greeting cards">
            <article class="card frosted-panel">
              <h3 class="card-title">Snowy wishes</h3>
              <p class="card-meta">From Jamie in Oslo</p>
              <p>
                May your cocoa stay warm and your playlists stay merry all
                season long.
              </p>
            </article>
            <article class="card frosted-panel">
              <h3 class="card-title">Candy cane cheer</h3>
              <p class="card-meta">From Priya in Toronto</p>
              <p>
                Here's to board games, bright lights, and laughter that echoes
                past midnight.
              </p>
            </article>
            <article class="card frosted-panel">
              <h3 class="card-title">Starlit skies</h3>
              <p class="card-meta">From Mateo in Quito</p>
              <p>
                Wishing you crisp nights, cozy blankets, and memories worth
                framing.
              </p>
            </article>
          </div>
        </div>
      </section>

      <div class="ribbon-divider"><span>Holiday mini-games</span></div>

      <section class="section" id="games">
        <div class="container">
          <h2 class="section-title">Mini-games lounge</h2>
          <p class="section-subtitle">
            Quick rounds of festive fun while the cocoa cools.
          </p>
          <div class="games-grid">
            <article class="game-card glow-accent">
              <span class="badge">New</span>
              <h3>Snowball Shuffle</h3>
              <p>Match the falling snowballs before they pile up too high.</p>
              <a class="btn secondary" href="#">Launch</a>
            </article>
            <article class="game-card glow-accent">
              <span class="badge">Co-op</span>
              <h3>Gift Wrap Relay</h3>
              <p>
                Race a friend to wrap gifts with perfect corners and glossy
                ribbons.
              </p>
              <a class="btn secondary" href="#">Launch</a>
            </article>
            <article class="game-card glow-accent">
              <span class="badge">Chill</span>
              <h3>Fireplace Lo-Fi</h3>
              <p>
                Compose a cozy beat with bells, crackles, and sleigh chimes.
              </p>
              <a class="btn secondary" href="#">Launch</a>
            </article>
          </div>
        </div>
      </section>

      <section class="section" id="guestbook">
        <div class="container">
          <h2 class="section-title">Sign the guestbook</h2>
          <p class="section-subtitle">
            Leave a note for the hosts or greet fellow guests.
          </p>
          <div class="guestbook">
            <form class="frosted-panel">
              <label for="name">Name</label>
              <input
                id="name"
                name="name"
                type="text"
                placeholder="Your name"
              />
              <label for="message">Message</label>
              <textarea
                id="message"
                name="message"
                rows="4"
                placeholder="Share some holiday cheer"
              ></textarea>
              <button class="btn" type="submit">Send</button>
            </form>
            <div class="frosted-panel">
              <h3 class="card-title">Latest notes</h3>
              <p>
                <strong>Alex</strong>: Can't wait for the gingerbread showdown!
              </p>
              <p>
                <strong>Rin</strong>: Saving a spot by the fire for everyone.
              </p>
              <p><strong>Lee</strong>: This guestbook is the coziest corner.</p>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer>
      <div class="container">
        <p class="section-title footer-title">Share the joy</p>
        <p class="section-subtitle footer-subtitle">
          Spread this experience with friends.
        </p>
        <ul class="share-buttons" aria-label="Share this page">
          <li><a href="#">Share on X</a></li>
          <li><a href="#">Share on Instagram</a></li>
          <li><a href="#">Copy invite link</a></li>
        </ul>
      </div>
    </footer>

    <script>
      const prefersReducedMotion = window.matchMedia(
        "(prefers-reduced-motion: reduce)"
      );

      const scene = document.querySelector(".parallax-scene");
      const layers = Array.from(scene?.querySelectorAll(".layer") || []);

      function applyParallax() {
        if (!scene || prefersReducedMotion.matches) return;

        const rect = scene.getBoundingClientRect();
        const centerY = rect.top + rect.height / 2;
        const scrollY = window.innerHeight / 2 - centerY;

        layers.forEach((layer) => {
          const depth = Number(layer.dataset.depth || 0);
          const translateY = scrollY * depth * 0.35;
          layer.style.transform = `translate3d(0, ${translateY}px, 0)`;
        });

        requestAnimationFrame(applyParallax);
      }

      const snowCanvas = document.getElementById("snow-canvas");
      const snowFallback = document.querySelector(".snow-fallback");

      function supportsWebGL() {
        try {
          const canvas = document.createElement("canvas");
          return !!(
            window.WebGLRenderingContext &&
            (canvas.getContext("webgl") || canvas.getContext("experimental-webgl"))
          );
        } catch (err) {
          return false;
        }
      }

      function initSnowCanvas() {
        if (!snowCanvas || prefersReducedMotion.matches || !supportsWebGL()) {
          snowCanvas?.setAttribute("hidden", "true");
          snowFallback?.removeAttribute("hidden");
          return initFallbackSnow();
        }

        const ctx = snowCanvas.getContext("2d");
        const flakes = Array.from({ length: 180 }, () => ({
          x: Math.random() * window.innerWidth,
          y: Math.random() * window.innerHeight,
          r: Math.random() * 3 + 1,
          s: Math.random() * 0.6 + 0.4,
        }));

        function resize() {
          snowCanvas.width = window.innerWidth;
          snowCanvas.height = scene.offsetHeight + 200;
        }

        function draw() {
          ctx.clearRect(0, 0, snowCanvas.width, snowCanvas.height);
          ctx.fillStyle = "rgba(255, 255, 255, 0.9)";
          flakes.forEach((flake) => {
            ctx.beginPath();
            ctx.arc(flake.x, flake.y, flake.r, 0, Math.PI * 2);
            ctx.fill();

            flake.y += flake.s * 3;
            flake.x += Math.sin(flake.y * 0.01) * 0.6;

            if (flake.y > snowCanvas.height) {
              flake.y = -flake.r;
              flake.x = Math.random() * snowCanvas.width;
            }
          });

          requestAnimationFrame(draw);
        }

        window.addEventListener("resize", resize);
        resize();
        draw();
      }

      function initFallbackSnow() {
        if (!snowFallback) return;
        snowFallback.querySelectorAll(".flake").forEach((flake, index) => {
          flake.style.setProperty("--delay", `${index * 1.2}s`);
        });
      }

      function initBottle() {
        const bottle = document.querySelector(".bottle-3d");
        if (!bottle) return;
        bottle.classList.toggle("reduced", prefersReducedMotion.matches);
      }

      window.addEventListener("scroll", () => {
        if (!prefersReducedMotion.matches) {
          requestAnimationFrame(applyParallax);
        }
      });

      prefersReducedMotion.addEventListener("change", () => {
        if (prefersReducedMotion.matches) {
          layers.forEach((layer) => (layer.style.transform = ""));
        }
        initBottle();
        initSnowCanvas();
      });

      initBottle();
      initSnowCanvas();
      requestAnimationFrame(applyParallax);
    </script>
  </body>
</html>
